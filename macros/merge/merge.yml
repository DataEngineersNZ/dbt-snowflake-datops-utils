version: 2

macros:
  - name: get_merge_statement
    description: Generate a MERGE statement between source and destination for incremental upsert logic.
    docs:
      show: true
    arguments:
      - name: source
        type: ref
        description: where the data is coming from
      - name: destination_table
        type: string
        description: where name of the table the data is going to
      - name: destination_schema
        type: string
        description: where name of the schame for the destination table
      - name: unique_key
        type: string
        description: key to perform the merge on
      - name: predicates
        type: object
        description: any additional columns to use during the merge

  - name: get_default_merge_statement
    description: Same as get_merge_statement but forces use of the default adapter macro implementation.
    docs:
      show: true
    arguments:
      - name: source
        type: ref
        description: where the data is coming from
      - name: destination_table
        type: string
        description: where name of the table the data is going to
      - name: destination_schema
        type: string
        description: where name of the schame for the destination table
      - name: unique_key
        type: string
        description: key to perform the merge on
      - name: predicates
        type: object
        description: any additional columns to use during the merge
