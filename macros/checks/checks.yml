version: 2

macros:
  - name: get_populated_array
    description: Return the first non-empty array among two candidate string arrays.
    docs:
      show: true
    arguments:
      - name: col_to_check
        type: List[string]
        description: Column to check to see if its populated
      - name: col_to_fall_back_on
        type: List[string]
        description: Column to fall back on if col_to_check is not populated

  - name: get_populated_array_value_as_string
    description: Join the first non-empty array (of two candidates) into a delimited string.
    docs:
      show: true
    arguments:
      - name: col_to_check
        type: List[string]
        description: Column to check to see if its populated
      - name: col_to_fall_back_on
        type: List[string]
        description: Column to fall back on if col_to_check is not populated

  - name: get_populated_array_value_or_string_as_string
    description: Return array contents as string if present else fall back to provided string value.
    docs:
      show: true
    arguments:
      - name: col_to_check
        type: List[string]
        description: Column to check to see if its populated
      - name: col_to_fall_back_on
        type: text
        description: Text based Column to fall back on if col_to_check is not populated

  - name: get_populated_numeric_value
    description: Return first non-null numeric value from two candidates else 0.
    docs:
      show: true
    arguments:
      - name: col_to_check
        type: number
        description: Column to check to see if its populated
      - name: col_to_fall_back_on
        type: number
        description: Column to fall back on if col_to_check is not populated

  - name: get_populated_string_value
    description: Return first non-empty string value from two candidates else empty string.
    docs:
      show: true
    arguments:
      - name: col_to_check
        type: text
        description: Column to check to see if its populated
      - name: col_to_fall_back_on
        type: text
        description: Column to fall back on if col_to_check is not populated
